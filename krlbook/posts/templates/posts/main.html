{% extends 'base.html' %}

{% block title %}
posts
{% endblock title %}

{% block content %}

<div class="ui grid">
    <div class="row">
        <div class="eleven wide column">
            {% for obj in qs%}
            <div class="ui fluid card">
                <div class="row">
                    {% ifequal request.user obj.author.user %}
                    <a href="{% url 'posts:post-update' obj.pk %}"><button class="ui button bwhite-lg">Update</button></a>
                    <a href="{% url 'posts:post-delete' obj.pk %}"><button class="ui button bwhite-lg">Delete</button></a>
                    {% endifequal %}
                </div>
                <img class="ui avatar image" src={{obj.author.avatar.url}}>
                {{ obj.author.user }} - {{ obj.created|timesince }} ago
                <div class="ui fluid image">
                    {% if obj.image%}
                        <img src={{obj.image.url}}>
                    {% endif %}
                </div>
                {{ obj.content }}
                <div class="content">
                    <form action="{% url 'posts:like-post-view'%}" method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="post_id" value={{obj.id}}>
                        <button type="submit" class="ui primary button">

                            {% if profile not in obj.liked.all %}
                                <i class="thumbs up icon"></i>&nbsp;Like
                            {% else %}
                                <i class="thumbs up icon"></i>&nbsp;Unlike
                            {% endif %}

                        </button>
                        &nbsp;{{obj.num_likes}}
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="five wide column">
            {% if post_added %}
                <div class="ui green message">Post added </div>
            {% endif %}
            <form action="" method="POST" class="ui form" enctype="multipart/form-data">
                {% csrf_token %}
                {{ p_form }}
                <button type="submit" class="ui button positive" name="submit_p_form">Send Post</button>
            </form>
        </div>
    </div>
</div>

{% endblock content %}